# ─────────────────────────────────────────────────────────────────────────────
# Porichoy — Environment Variables Template
#
# Copy this file to .env and fill in every value marked with <CHANGE_ME>.
# NEVER commit .env to version control.
# ─────────────────────────────────────────────────────────────────────────────

# ── Application ───────────────────────────────────────────────────────────────
NODE_ENV=development          # development | production | test
PORT=3001
LOG_LEVEL=info                # trace | debug | info | warn | error | fatal

# ── CORS ─────────────────────────────────────────────────────────────────────
# Comma-separated list of allowed origins (no trailing slash)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# ── PostgreSQL ────────────────────────────────────────────────────────────────
# Connection string consumed by Prisma.
# When running via docker-compose the api service overrides this automatically.
DATABASE_URL=postgresql://porichoy:<CHANGE_ME>@localhost:5432/porichoy?schema=public

# Values used by docker-compose postgres service directly:
POSTGRES_DB=porichoy
POSTGRES_USER=porichoy
POSTGRES_PASSWORD=<CHANGE_ME>
POSTGRES_PORT=5432

# ── Redis ─────────────────────────────────────────────────────────────────────
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=<CHANGE_ME>
REDIS_DB=0
# Full URL overrides individual fields if set:
# REDIS_URL=redis://:password@localhost:6379/0

# ── JWT ───────────────────────────────────────────────────────────────────────
# Generate with: openssl rand -hex 64
JWT_ACCESS_SECRET=<CHANGE_ME_64_HEX_CHARS>
JWT_REFRESH_SECRET=<CHANGE_ME_64_HEX_CHARS>

# Token lifetimes — use ms notation: 15m, 7d, 1h
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# ── Encryption ────────────────────────────────────────────────────────────────
# AES-256 key: must be exactly 64 hex characters (32 bytes)
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=<CHANGE_ME_64_HEX_CHARS>

# Field-level encryption key for PII stored in DB (same format as above)
FIELD_ENCRYPTION_KEY=<CHANGE_ME_64_HEX_CHARS>

# ── MinIO / S3-compatible Object Storage ─────────────────────────────────────
S3_ENDPOINT=http://localhost:9000
S3_REGION=ap-south-1
S3_ACCESS_KEY_ID=<CHANGE_ME>
S3_SECRET_ACCESS_KEY=<CHANGE_ME>
S3_BUCKET_DOCUMENTS=porichoy-documents
S3_BUCKET_PHOTOS=porichoy-photos
S3_FORCE_PATH_STYLE=true       # Required for MinIO; false for AWS S3

# MinIO console ports (docker-compose only)
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001

# ── File Upload ───────────────────────────────────────────────────────────────
# Max file size in bytes (default 10 MB)
MAX_FILE_SIZE_BYTES=10485760
# Allowed MIME types (comma-separated)
ALLOWED_MIME_TYPES=image/jpeg,image/png,application/pdf

# ── Rate Limiting ─────────────────────────────────────────────────────────────
RATE_LIMIT_WINDOW_MS=900000    # 15 minutes
RATE_LIMIT_MAX=100             # requests per window (global)
AUTH_RATE_LIMIT_MAX=5          # login/register attempts per window
SENSITIVE_RATE_LIMIT_MAX=10    # OTP / password-reset per window
UPLOAD_RATE_LIMIT_MAX=20       # document uploads per window

# ── Security ──────────────────────────────────────────────────────────────────
BCRYPT_ROUNDS=12
# Progressive lockout: lock after N consecutive failed logins
MAX_LOGIN_ATTEMPTS=5
# Lock duration in seconds (15 minutes)
LOCKOUT_DURATION_SECONDS=900

# ── Session ───────────────────────────────────────────────────────────────────
# How long a session cookie is valid (seconds). Must match JWT_REFRESH_TOKEN_EXPIRY.
SESSION_MAX_AGE_SECONDS=604800  # 7 days

# ── External APIs ─────────────────────────────────────────────────────────────
# Bangladesh NID Registrar API (EC NID Verification)
NID_REGISTRAR_API_URL=https://nid.example.gov.bd/api/v1
NID_REGISTRAR_API_KEY=<CHANGE_ME>

# Birth and Death Registration API
BDRIS_API_URL=https://bdris.example.gov.bd/api/v1
BDRIS_API_KEY=<CHANGE_ME>

# ClamAV antivirus daemon (for document scanning)
# Leave blank to disable virus scanning (not recommended in production)
CLAMAV_HOST=localhost
CLAMAV_PORT=3310

# ── Email / SMS Notifications (optional) ─────────────────────────────────────
# SMTP
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=<CHANGE_ME>
SMTP_PASS=<CHANGE_ME>
SMTP_FROM="Porichoy Platform <noreply@porichoy.gov.bd>"

# SMS gateway (Twilio / BDsms / etc.)
SMS_API_URL=https://sms.example.bd/api/send
SMS_API_KEY=<CHANGE_ME>
SMS_SENDER_ID=PORICHOY

# ── pgAdmin (dev only — docker-compose --profile dev) ────────────────────────
PGADMIN_EMAIL=admin@porichoy.gov.bd
PGADMIN_PASSWORD=<CHANGE_ME>
PGADMIN_PORT=5050
