import{r as i,j as e,m as c,C as o}from"./index-TXT2zbz-.js";import{S as v}from"./search-B0CkwVU2.js";import{I as f}from"./info-DgQRGOc_.js";import{C as d}from"./circle-alert-T-TtwyDS.js";import{C as n}from"./circle-check-CgDq_TC4.js";const j=[{id:"AUD001",eventType:"login",actor:"admin",action:"Admin login successful",resourceType:"session",resourceId:"sess-admin-001",status:"success",timestamp:"2024-02-25 14:30:25",ipAddress:"192.168.1.100"},{id:"AUD002",eventType:"verification",actor:"Mohammad Rahim",action:"Identity verified",resourceType:"citizen",resourceId:"citizen-001",status:"success",timestamp:"2024-02-25 14:28:10",ipAddress:"203.0.113.45"},{id:"AUD003",eventType:"approval",actor:"admin",action:"Application approved",resourceType:"application",resourceId:"APP001",status:"success",timestamp:"2024-02-25 14:15:30",ipAddress:"192.168.1.100"},{id:"AUD004",eventType:"error",actor:"system",action:"Failed login attempt",resourceType:"session",resourceId:"sess-failed-001",status:"failure",timestamp:"2024-02-25 14:10:15",ipAddress:"203.0.113.50"},{id:"AUD005",eventType:"rejection",actor:"admin",action:"Application rejected",resourceType:"application",resourceId:"APP005",status:"success",timestamp:"2024-02-25 13:55:45",ipAddress:"192.168.1.100"}],b=r=>{switch(r){case"login":return e.jsx(n,{className:"w-5 h-5 text-blue-600"});case"logout":return e.jsx(o,{className:"w-5 h-5 text-gray-600"});case"approval":return e.jsx(n,{className:"w-5 h-5 text-green-600"});case"rejection":return e.jsx(d,{className:"w-5 h-5 text-red-600"});case"verification":return e.jsx(n,{className:"w-5 h-5 text-purple-600"});case"error":return e.jsx(d,{className:"w-5 h-5 text-red-600"});default:return e.jsx(f,{className:"w-5 h-5 text-gray-600"})}},N=r=>{switch(r){case"login":return"bg-blue-50 border-blue-200";case"logout":return"bg-gray-50 border-gray-200";case"approval":return"bg-green-50 border-green-200";case"rejection":return"bg-red-50 border-red-200";case"verification":return"bg-purple-50 border-purple-200";case"error":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}},A=r=>r==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700";function E(){const[r,u]=i.useState(""),[t,p]=i.useState("all"),[a,m]=i.useState("all"),l=j.filter(s=>{const h=s.action.toLowerCase().includes(r.toLowerCase())||s.actor.toLowerCase().includes(r.toLowerCase())||s.resourceId.includes(r)||s.ipAddress.includes(r),y=t==="all"||s.eventType===t,g=a==="all"||s.status===a;return h&&y&&g}),x=["login","logout","approval","rejection","verification","error"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(o,{className:"w-8 h-8 text-[rgb(var(--color-primary))]"}),"Audit Logs"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"System activity and user actions"})]}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-2xl p-6 border border-gray-200 space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by action, actor, resource, or IP...",value:r,onChange:s=>u(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))]"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("select",{value:t,onChange:s=>p(s.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))]",children:[e.jsx("option",{value:"all",children:"All Event Types"}),x.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))]}),e.jsxs("select",{value:a,onChange:s=>m(s.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))]",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failure",children:"Failure"})]})]})]}),e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"space-y-3",children:l.map(s=>e.jsx("div",{className:`border rounded-xl p-4 transition hover:shadow-md ${N(s.eventType)}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"pt-1",children:b(s.eventType)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.action}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full ${A(s.status)}`,children:s.status==="success"?"Success":"Failed"}),e.jsx("span",{className:"text-xs text-gray-600",children:s.timestamp})]})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Actor:"})," ",s.actor]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",s.resourceType]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Resource:"})," ",s.resourceId]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"IP:"})," ",s.ipAddress]})]})]})]})},s.id))}),l.length===0&&e.jsxs("div",{className:"p-8 text-center text-gray-500 bg-white rounded-2xl border border-gray-200",children:[e.jsx(o,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No audit logs found matching your filters"})]})]})}export{E as AdminAudit};
